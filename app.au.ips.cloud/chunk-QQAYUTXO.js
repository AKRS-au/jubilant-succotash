import{c as ee,e as le}from"./chunk-YGAJRIQG.js";var de=le((ie,oe)=>{var te=ie&&ie.__extends||function(t,A){for(var b in A)A.hasOwnProperty(b)&&(t[b]=A[b]);function H(){this.constructor=t}H.prototype=A.prototype,t.prototype=new H};(function(t){typeof ie=="object"&&typeof oe<"u"?oe.exports=t():typeof define=="function"&&define.amd?define([],t):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).OneDrive=t()})(function(){return function t(A,b,H){function i(u,p){if(!b[u]){if(!A[u]){var s=typeof ee=="function"&&ee;if(!p&&s)return s(u,!0);if(o)return o(u,!0);var E=new Error("Cannot find module '"+u+"'");throw E.code="MODULE_NOT_FOUND",E}var c=b[u]={exports:{}};A[u][0].call(c.exports,function(a){return i(A[u][1][a]||a)},c,c.exports,t,A,b,H)}return b[u].exports}for(var o=typeof ee=="function"&&ee,e=0;e<H.length;e++)i(H[e]);return i}({1:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(){}return e.SDK_VERSION="js-v"+(e.SDK_VERSION_NUMBER="7.2"),e.TYPE_BOOLEAN="boolean",e.TYPE_FUNCTION="function",e.TYPE_OBJECT="object",e.TYPE_STRING="string",e.TYPE_NUMBER="number",e.VROOM_URL="https://api.onedrive.com/v1.0/",e.VROOM_ENDPOINT_HINT="api.onedrive.com",e.GRAPH_URL="https://graph.microsoft.com/v1.0/",e.NONCE_LENGTH=5,e.CUSTOMER_TID="9188040d-6c67-4c5b-b112-36a304b66dad",e.DEFAULT_QUERY_ITEM_PARAMETER="select=id",e}();i.default=o})(0,b)},{}],2:[function(t,A,b){A.exports=function(H,i,o,e){"use strict";var u=function(){function p(){}return p.open=function(s){o.default.open(s)},p.save=function(s){o.default.save(s)},p}();return e.onAuth(),u}(0,0,t("./OneDriveApp"),t("./controllers/Oauth"))},{"./OneDriveApp":3,"./controllers/Oauth":7}],3:[function(t,A,b){(function(H,i,o,e,u,p,s,E){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var c=function(){function a(){}return a.open=function(g){a.isReady()&&(g||o.throwError(new p.default(e.default.unknown,"missing picker options")).exposeToPublic(),u.default.logMessage("open started"),new s.default(g).launchInvoker().then(function(){a.reset()}))},a.save=function(g){a.isReady()&&(g||o.throwError(new p.default(e.default.unknown,"missing saver options")),u.default.logMessage("save started"),new E.default(g).launchInvoker().then(function(){a.reset()}))},a.reset=function(){a.checked=!1},a.isReady=function(){return!a.checked&&(a.checked=!0)},a.checked=!1,a}();i.default=c})(0,b,t("./utilities/ErrorHandler"),t("./models/ErrorType"),t("./utilities/Logging"),t("./models/OneDriveSdkError"),t("./controllers/Picker"),t("./controllers/Saver"))},{"./controllers/Picker":8,"./controllers/Saver":10,"./models/ErrorType":13,"./models/OneDriveSdkError":16,"./utilities/ErrorHandler":26,"./utilities/Logging":27}],4:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c,a,g){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var h=100,d=5,P=18e5,v="root";function r(l,m,y){var _=w(l,m.apiEndpointUrl);y&&(_=c.appendToPath(_,"?"+y));var R=new a.default({url:_,clientId:m.clientId,method:a.default.HTTP_GET,apiEndpoint:m.apiEndpoint,headers:{Authorization:"bearer "+m.accessToken}});return u.default.logMessage("performing GET on item with id: "+l.id),new g.Promise(function(k,O){R.start(function(D,C){var L=JSON.parse(D.responseText);k(L)},function(D,C,L){O({errorCode:e.default[e.default.webRequestFailure],message:"HTTP error status: "+C})})})}i.getItem=r,i.getItems=function(l,m,y){for(var _=[],R={webUrl:null,value:[]},k=0,O=l.value;k<O.length;k++){var D=O[k];_.push(r(D,m,y))}return g.Promise.all(_).then(function(C){return R.value=C,R},function(C){return u.default.logError("Received ajax error.",C),C})};function f(l,m,y){var _=c.appendToPath(w(l,m.apiEndpointUrl),E.format("{0}.createLink",m.apiActionNamingSpace)),R=new a.default({url:_,clientId:m.clientId,method:a.default.HTTP_POST,apiEndpoint:m.apiEndpoint,headers:{Authorization:"bearer "+m.accessToken},json:JSON.stringify(y)});return new g.Promise(function(k,O){R.start(function(D,C,L){u.default.logMessage(E.format("POST createLink succeeded via path {0}",_)),l.permissions=[JSON.parse(D.responseText)],k(l)},function(D,C,L){u.default.logMessage(E.format("POST createLink failed via path {0}",_)),O({errorCode:e.default[e.default.webRequestFailure],message:C})})})}i.shareItem=f,i.shareItems=function(l,m,y){for(var _=[],R={webUrl:null,value:[]},k=0,O=l.value;k<O.length;k++){var D=O[k];_.push(f(D,m,y))}return g.Promise.all(_).then(function(C){return R.value=C,R},function(C){return u.default.logError("Received sharing error.",C),C})},i.saveItemByFormUpload=function(l,m,y,_,R){var k=null;return new g.Promise(function(O,D){window.File&&y instanceof window.File?k=new FileReader:D(new s.default(e.default.unsupportedFeature,"FileReader is not supported in this browser")),k.onerror=function(C){u.default.logError("failed to read or upload the file",C),D(new s.default(e.default.fileReaderFailure,"failed to read or upload the file, see console log for details"))},k.onload=function(C){var L=c.appendToPath(w(l,_.apiEndpointUrl),"children('"+m.name+"')/content"),M={};M["@name.conflictBehavior"]=m["@name.conflictBehavior"];var U={};U.Authorization="bearer "+_.accessToken,U["Content-Type"]="multipart/form-data";var S=new a.default({url:c.appendQueryStrings(L,M),clientId:_.clientId,headers:U,apiEndpoint:_.apiEndpoint}),x=C.target.result;S.upload(x,function(F,Y){O({webUrl:null,value:[JSON.parse(F.responseText)]})},function(F,Y,V){D(new s.default(e.default.webRequestFailure,E.format("file uploading failed by form uplaod with HTTP status: {0}",Y)))},function(F,Y){R(Y.progressPercentage)})},k.readAsArrayBuffer(y)})},i.saveItemByUriUpload=function(l,m,y,_){if(_.apiEndpoint===o.default.filesV2||_.apiEndpoint===o.default.graph_odb)return new g.Promise(function(M,U){U(new s.default(e.default.unsupportedFeature,"URL upload not supported for OneDrive business"))});var R,k=c.appendToPath(w(l,_.apiEndpointUrl),"children"),O={Prefer:"respond-async"};O.Authorization="bearer "+_.accessToken,m[R=_.apiEndpoint,R===o.default.graph_odb||R===o.default.graph_odc?"@microsoft.graph.sourceUrl":"@content.sourceUrl"]=y,m.file={};var D,C,L=new a.default({url:k,clientId:_.clientId,method:a.default.HTTP_POST,headers:O,json:JSON.stringify(m),apiEndpoint:_.apiEndpoint});return c.isPathDataUrl(y)?(C=L,new g.Promise(function(M,U){C.start(function(S,x){if(x===200||x===201){var F={webUrl:null,value:[p.deserializeJSON(S.responseText)]};M(F)}else U(new s.default(e.default.webRequestFailure,E.format("file uploading failed by data uri with HTTP status: {0}",x)))},function(S,x,F){U(new s.default(e.default.webRequestFailure,E.format("file uploading failed with HTTP status: {0}",x)))})})):c.isPathFullUrl(y)?(D=L,new g.Promise(function(M,U){D.start(function(S,x){if(x===202){var F=S.getResponseHeader("Location");F||U({errorCode:e.default.badResponse,message:"missing 'Location' header on response"}),M(F)}else U(new s.default(e.default.webRequestFailure,E.format("create upload by url job failed with HTTP status: {0}",x)))},function(S,x,F){U(new s.default(e.default.webRequestFailure,E.format("create upload by url job failed with HTTP status: {0}",x)))})})).then(function(M){return(U=M,new g.Promise(function(S,x){(function F(Y,V){Y--||(V*=2,Y=d),(Q=U,K=new a.default({url:Q,method:a.default.HTTP_GET}),new g.Promise(function(G,X){K.start(function(B,Z){switch(Z){case 202:case 200:var n=p.deserializeJSON(B.responseText);G(n);break;default:X(new s.default(e.default.webRequestFailure,E.format("polling upload job failed with HTTP status: {0}",Z)))}},function(B,Z,n){X(new s.default(e.default.webRequestFailure,E.format("polling upload job failed with HTTP status: {0}",Z)))})})).then(function(G){G.resourceId?S(G.resourceId):V<=P?setTimeout(F(Y,V),V):x(new s.default(e.default.webRequestFailure,"polling the uploading job takes too much time"))});var Q,K})(d,h)})).then(function(S){return r({id:S},_).then(function(x){var F={webUrl:null,value:[x]};return g.Promise.resolve(F)})});var U}):void 0},i.getUserTenantUrl=function(l){var m=c.appendQueryString(c.appendToPath(l.apiEndpointUrl,"me"),"$select","mySite"),y={};y.Authorization="bearer "+l.accessToken,y.Accept="application/json";var _=new a.default({url:m,clientId:l.clientId,method:a.default.HTTP_GET,headers:y,apiEndpoint:l.apiEndpoint});return new g.Promise(function(R,k){_.start(function(O,D){var C=p.deserializeJSON(O.responseText);C.mySite?R(C.mySite):k(new s.default(e.default.badResponse,E.format("Cannot find the personal tenant url, response text: {0}",O.responseText)))},function(O,D,C){k(new s.default(e.default.webRequestFailure,E.format("graph/me request failed, status code: '{0}', response text: '{1}'",a.default.statusCodeToString(D),O.responseText)))})})};function w(l,m){var y;return y=l.parentReference&&l.parentReference.driveId?c.appendToPath("drives",l.parentReference.driveId):"drive",y=c.appendToPath(y,l.id===v?"root":"items/"+l.id),c.appendToPath(m,y)}})(0,b,t("../models/ApiEndpoint"),t("../models/ErrorType"),t("../utilities/Logging"),t("../utilities/ObjectUtilities"),t("../models/OneDriveSdkError"),t("../utilities/StringUtilities"),t("../utilities/UrlUtilities"),t("../utilities/XHR"),t("es6-promise"))},{"../models/ApiEndpoint":11,"../models/ErrorType":13,"../models/OneDriveSdkError":16,"../utilities/Logging":27,"../utilities/ObjectUtilities":28,"../utilities/StringUtilities":30,"../utilities/UrlUtilities":32,"../utilities/XHR":33,"es6-promise":34}],5:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c,a,g,h,d,P,v,r,f){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var w=function(){function l(m){this.invokerOptions=m,this.popup=new P.default}return l.prototype.launchInvoker=function(){var m=this,y=this.invokerOptions;return this.launch().catch(function(_){c.default.logError("Failed due to unknown error: ",_),y.error(_)}).then(function(){m.cleanPopupAndIFrame()})},l.prototype.launch=function(m){var y=this;return this.buildOauthPromise(m).then(function(_){return _&&_.type==="cancel"?_:y.buildPickerUI(_)}).then(function(_){var R=y.invokerOptions;if(_.type||s.throwError(new h.default(E.default.badResponse,r.format("received bad response from picker UX: {0}",JSON.stringify(_)))).exposeToPublic(),_.type==="switch")return y.launch(!0);if(_.type==="success"){for(var k=[],O=!1,D=0,C=_.items;D<C.length;D++){var L=C[D];L.driveItem&&!O&&(O=!0),k.push(L)}var M={webUrl:null,value:k},U=void 0;return!R.needAPICall()||O&&R.accessToken.toLowerCase()==="rps"?(y.invokerOptions.forceAuthenticate&&(y.apiRequestConfig=y.buildApiConfig()),U=v.Promise.resolve(M)):(y.apiRequestConfig=y.buildApiConfig(),U=y.makeApiRequest(M)),U.then(function(S){return y.oauthResponse&&(S.accessToken=y.oauthResponse.accessToken),y.apiRequestConfig?S.apiEndpoint=y.apiRequestConfig.apiEndpointUrl:y.loginHint&&y.loginHint.endpointHint===p.default.aad&&(S.apiEndpoint=u.default.GRAPH_URL),R.success(S),S})}if(_.type==="cancel")return R.cancel(),v.Promise.resolve({webUrl:null,value:null})})},l.prototype.buildOauthPromise=function(m){return m||this.invokerOptions.needOauth()?g.auth(g.buildOauthConfig(this.invokerOptions,m),this.popup):v.Promise.resolve(null)},l.prototype.buildPickerUI=function(m){var y,_=this;if(m)this.oauthResponse=m,y=a.updateLoginHint(this.invokerOptions.clientId,this.oauthResponse.idToken,this.invokerOptions);else{this.invokerOptions.endpointHint!==p.default.msa&&this.invokerOptions.endpointHint!==p.default.tenant&&s.throwError(new h.default(E.default.optionsError,"must specify the endpointHint in advanced options as 'api.onedrive.com' for customer picker or the url for business picker/tenant")).exposeToPublic();var R=this.invokerOptions.endpointHint===p.default.msa;y={loginHint:null,timeStamp:null,apiEndpoint:R?o.default.msa:o.default.filesV2,endpointHint:R?p.default.msa:p.default.tenant,isConsumerAccount:R}}return((this.loginHint=y).apiEndpoint===o.default.graph_odb?e.getUserTenantUrl(this.buildApiConfig()):v.Promise.resolve(void 0)).then(function(k){_.pickerUX=d.generatePickerUX(y.apiEndpoint,y.endpointHint===p.default.tenant?_.invokerOptions.siteUrl:k);var O=_.buildPickerUXConfig(_.invokerOptions);return _.invokerOptions.navEntryLocation&&(O.entryLocation=_.invokerOptions.navEntryLocation),_.invokerOptions.navSourceTypes&&(O.sourceTypes=_.invokerOptions.navSourceTypes),_.invokerOptions.linkType&&(O.linkType=_.invokerOptions.linkType),O.trapFocus=_.invokerOptions.trapFocus,_.pickerUX.invokePickerUX(O,_.popup)})},l.prototype.getApiRequestConfig=function(){return this.apiRequestConfig},l.prototype.buildApiConfig=function(){this.loginHint||s.throwError(new h.default(E.default.internalError,"missing loginHint when trying to build API request")).exposeToPublic(),this.oauthResponse||this.invokerOptions.accessToken||s.throwError(new h.default(E.default.internalError,"missing access token when trying to build API request")).exposeToPublic();var m=null,y=null;switch(this.loginHint.apiEndpoint){case o.default.graph_odb:case o.default.graph_odc:m=u.default.GRAPH_URL,y="microsoft.graph";break;case o.default.msa:m=u.default.VROOM_URL,y="action";break;case o.default.filesV2:m=f.appendToPath(this.invokerOptions.siteUrl,"_api/v2.0/"),y="action";break;default:s.throwError(new h.default(E.default.internalError,"apiEndpoint in loginHint is not correct"))}return{accessToken:this.oauthResponse?this.oauthResponse.accessToken:this.invokerOptions.accessToken,apiEndpoint:this.loginHint.apiEndpoint,apiEndpointUrl:m,apiActionNamingSpace:y,clientId:this.invokerOptions.clientId}},l.prototype.cleanPopupAndIFrame=function(){this.popup&&this.popup.close(),this.pickerUX&&this.pickerUX.removeIFrame()},l}();i.default=w})(0,b,t("../models/ApiEndpoint"),t("./ApiRequest"),t("../Constants"),t("../models/DomainHint"),t("../utilities/ErrorHandler"),t("../models/ErrorType"),t("../utilities/Logging"),t("./LoginCache"),t("./Oauth"),t("../models/OneDriveSdkError"),t("./PickerUX"),t("../utilities/Popup"),t("es6-promise"),t("../utilities/StringUtilities"),t("../utilities/UrlUtilities"))},{"../Constants":1,"../models/ApiEndpoint":11,"../models/DomainHint":12,"../models/ErrorType":13,"../models/OneDriveSdkError":16,"../utilities/ErrorHandler":26,"../utilities/Logging":27,"../utilities/Popup":29,"../utilities/StringUtilities":30,"../utilities/UrlUtilities":32,"./ApiRequest":4,"./LoginCache":6,"./Oauth":7,"./PickerUX":9,"es6-promise":34}],6:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var g="preferred_username",h="odsdkLoginHint";i.getLoginHint=function(d){d||s.throwError(new c.default(E.default.optionsError,"invoker option is not defined!"));var P=(e.getCacheItem(h)||{})["od7-"+d.clientId];return P?d.endpointHint!==P.endpointHint||d.loginHint&&d.loginHint!==P.loginHint?null:P:null},i.loginHintExpired=function(){var d=e.getCacheItem(h);return 36e5<new Date().getTime()-d.timeStamp},i.updateLoginHint=function(d,P,v){var r,f,w,l;switch(v.endpointHint){case p.default.aad:var m=this.parseIdToken(P);r=m.preferredUserName,m.tid===u.default.CUSTOMER_TID?(w=o.default.graph_odc,l=!0):(w=o.default.graph_odb,l=!1),f=p.default.aad;break;case p.default.msa:w=o.default.msa,f=p.default.msa,r=v.loginHint,l=!0;break;case p.default.tenant:w=o.default.filesV2,f=p.default.tenant,r=v.loginHint,l=!1}var y={apiEndpoint:w,loginHint:r,endpointHint:f,timeStamp:new Date().getTime(),isConsumerAccount:l},_=e.getCacheItem(h)||{};return _["od7-"+d]=y,e.setCacheItem(h,_),y},i.parseIdToken=function(d){d||s.throwError(new c.default(E.default.badResponse,"id_token is missing in oauth response"));var P=d.split(".")[1].replace("-","+").replace("_","/"),v=a.deserializeJSON(atob(P));return v.tid||s.throwError(new c.default(E.default.badResponse,"tid is missing in id_token response")),v[g]||s.throwError(new c.default(E.default.badResponse,"preferred_username is missing in id_token response")),{tid:v.tid,preferredUserName:v[g]}}})(0,b,t("../models/ApiEndpoint"),t("../utilities/Cache"),t("../Constants"),t("../models/DomainHint"),t("../utilities/ErrorHandler"),t("../models/ErrorType"),t("../models/OneDriveSdkError"),t("../utilities/ObjectUtilities"))},{"../Constants":1,"../models/ApiEndpoint":11,"../models/DomainHint":12,"../models/ErrorType":13,"../models/OneDriveSdkError":16,"../utilities/Cache":22,"../utilities/ErrorHandler":26,"../utilities/ObjectUtilities":28}],7:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c,a,g,h){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var d="access_token",P="error",v="error_description",r="id_token",f="oauth",w="state",l="https://login.microsoftonline.com/common/oauth2/authorize",m="https://login.microsoftonline.com/common/oauth2/v2.0/authorize",y="https://login.live.com/oauth20_authorize.srf",_="[OneDriveSDK-OauthResponse]";i.onAuth=function(){u.onDocumentReady(function(){var O=h.readCurrentUrlParameters();(O[f]||(O[P]||O[d])&&O[w])&&window.opener&&R(O,new o.default(window.opener))})};function R(O,D){u.displayOverlay(),O[f]?function(M){var U;switch(M.endpoint){case c.default.AAD:U=(Y=M,h.appendQueryStrings(l,{redirect_uri:Y.redirectUri,client_id:Y.clientId,response_type:"token",state:Y.state,resource:Y.resource||Y.origin}));break;case c.default.AADv2:U=(x="profile openid https://graph.microsoft.com/User.Read "+(S=M).scopes.map(function(V){return"https://graph.microsoft.com/"+V}).join(" "),F=h.appendQueryStrings(m,{redirect_uri:S.redirectUri,client_id:S.clientId,scope:x,response_mode:"fragment",state:S.state,nonce:h.generateNonce()}),F+="&response_type=id_token+token");break;case c.default.MSA:U=function(V){for(var Q=!1,K=0,G=V.scopes;K<G.length;K++){var X=G[K];Q=Q||1<X.toLowerCase().indexOf("readwrite")}return h.appendQueryStrings(y,{redirect_uri:V.redirectUri,client_id:V.clientId,response_type:"token",state:V.state,scope:"onedrive."+(Q?"readwrite":"readonly")})}(M);break;default:p.throwError(new a.default(s.default.badResponse,"received bad oauth endpoint, endpoint value is: "+M.endpoint))}var S,x,F,Y;M.switchAccount?U=h.appendQueryString(U,"prompt","select_account"):M.loginHint&&(U=h.appendQueryString(U,"login_hint",M.loginHint),U=h.appendQueryString(U,"domain_hint",M.isConsumerAccount?"consumers":"organizations")),h.redirect(U)}(JSON.parse(O[f])):O[P]?k((L=O,{type:"error",error:new a.default(s.default.badResponse,L[v]),state:L[w]}),D):O[d]&&k({type:"success",accessToken:(C=O)[d],idToken:C[r],state:C[w]},D);var C,L}i.handleOauth=R;function k(O,D){O.state?(O.state.split("_").length!==2&&p.throwError(new a.default(s.default.badResponse,"received bad state parameter from Oauth endpoint, state received: "+O.state)).exposeToPublic(),D?D.send(_+JSON.stringify(O),window.location.origin):p.throwError(new a.default(s.default.popupOpen,"opener is not defined")).exposeToPublic()):p.throwError(new a.default(s.default.badResponse,"missing state parameter from Oauth redirect")).exposeToPublic()}i.auth=function(O,D){var C=document.location.origin+"_"+h.generateNonce();return O.state=C,new g.Promise(function(L,M){var U=u.onMessage(function(S){if(S.data&&S.data.indexOf(_)===0){var x=JSON.parse(S.data.substring(_.length));if(x.state===C&&S.source===D.getPopupWindow())if(u.removeMessageListener(U),x.type==="error"||x.error){var F=s.default[x.error.errorCode];M(new a.default(F,x.error.message))}else L(x);else M(new a.default(s.default.popupOpen,"Another popup is already opened."))}});return D.openPopup(h.appendQueryString(O.redirectUri,f,JSON.stringify(O))).then(function(){L({type:"cancel",state:C})})})},i.buildOauthConfig=function(O,D){var C;switch(O.endpointHint){case e.default.aad:C=c.default.AADv2;break;case e.default.msa:C=c.default.MSA;break;case e.default.tenant:C=c.default.AAD}var L=O.scopes.map(function(S){return S+(-1<S.indexOf("Files.")&&O.needSharePointPermission?".All":"")}),M={clientId:O.clientId,endpoint:C,scopes:L,origin:window.location.origin,redirectUri:O.redirectUri,switchAccount:D,resource:O.resource},U=E.getLoginHint(O);return O.loginHint?(M.loginHint=O.loginHint,M.isConsumerAccount=O.isConsumerAccount):U&&(M.loginHint=U.loginHint,M.isConsumerAccount=U.isConsumerAccount),M}})(0,b,t("../utilities/Channel"),t("../models/DomainHint"),t("../utilities/DomUtilities"),t("../utilities/ErrorHandler"),t("../models/ErrorType"),t("./LoginCache"),t("../models/OauthEndpoint"),t("../models/OneDriveSdkError"),t("es6-promise"),t("../utilities/UrlUtilities"))},{"../models/DomainHint":12,"../models/ErrorType":13,"../models/OauthEndpoint":15,"../models/OneDriveSdkError":16,"../utilities/Channel":24,"../utilities/DomUtilities":25,"../utilities/ErrorHandler":26,"../utilities/UrlUtilities":32,"./LoginCache":6,"es6-promise":34}],8:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c,a,g){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var h=function(d){te(P,d);function P(v){var r=s.shallowClone(v),f=new E.default(r);return d.call(this,f)||this}return P.prototype.buildPickerUXConfig=function(v){return{applicationId:v.clientId,accessLevel:P.ACCESS_LEVEL,filter:v.filter,id:g.generateNonce(),navEnabled:v.navEnabled,origin:window.location.origin,parentDiv:v.parentDiv,redirectUri:v.redirectUri,selectionMode:v.multiSelect?"multiple":"single",viewType:v.viewType||"files",accountSwitchEnabled:v.accountSwitchEnabled,commandMode:v.commandMode,qosExtraData:v.qosExtraData}},P.prototype.makeApiRequest=function(v){if(this.invokerOptions.action===c.default.share)return this.shareItems(v);var r=this.invokerOptions.action===c.default.download;return this.queryItems(v,r)},P.prototype.queryItems=function(v,r){var f=this.invokerOptions.queryParameters||u.default.DEFAULT_QUERY_ITEM_PARAMETER;return r&&(f=a.format("{0}{1}{2}",f,f.indexOf("select")===-1?"&select=":",","name,size,@content.downloadUrl")),e.getItems(v,this.getApiRequestConfig(),f)},P.prototype.shareItems=function(v){var r=this,f=this.invokerOptions.createLinkParameters||this.getDefaultSharingConfig();return e.getItems(v,this.getApiRequestConfig()).then(function(w){return e.shareItems(w,r.getApiRequestConfig(),f)})},P.prototype.getDefaultSharingConfig=function(){var v={type:"view"};return this.getApiRequestConfig().apiEndpoint===o.default.graph_odc||this.getApiRequestConfig().apiEndpoint===o.default.msa||(v.scope="organization"),v},P.ACCESS_LEVEL="read",P}(p.default);i.default=h})(0,b,t("../models/ApiEndpoint"),t("./ApiRequest"),t("../Constants"),t("./Invoker"),t("../utilities/ObjectUtilities"),t("../models/PickerOptions"),t("../models/PickerActionType"),t("../utilities/StringUtilities"),t("../utilities/UrlUtilities"))},{"../Constants":1,"../models/ApiEndpoint":11,"../models/PickerActionType":17,"../models/PickerOptions":18,"../utilities/ObjectUtilities":28,"../utilities/StringUtilities":30,"../utilities/UrlUtilities":32,"./ApiRequest":4,"./Invoker":5}],9:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c,a,g,h){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var d="[OneDrive-FromPicker]";i.generatePickerUX=function(v,r){return new P(v,r)};var P=function(){function v(r,f){r===o.default.graph_odc||r===o.default.msa?this.url=a.appendQueryStrings("https://onedrive.live.com/",{v:"2"}):(r===o.default.graph_odb||r===o.default.filesV2)&&(f||p.throwError(new c.default(s.default.optionsError,"the site url must be specified")).exposeToPublic(),a.validateUrlProtocol(f,["HTTPS"]),r===o.default.graph_odb&&(f=a.appendToPath(f,"_layouts/onedrive.aspx")),this.url=a.appendQueryString(f,"p","2"))}return v.prototype.invokePickerUX=function(r,f){var w=this;return new g.Promise(function(l,m){var y=u.onMessage(function(O){var D=w.url.split("/"),C=new e.default(w.iframe?w.iframe.contentWindow:f.getPopupWindow());if(O.origin===D[0]+"//"+D[2]){var L=""+(O.data||"");if(L.indexOf(d)===0&&O.source===C.getReceiver()){var M=JSON.parse(L.substring(d.length)),U=M.pickerId,S=M.conversationId,x=M.type;U===r.id&&(x==="initialize"?C.send("[OneDrive-ToPicker]"+JSON.stringify({pickerId:U,conversationId:S,type:"activate"}),O.origin):(l(M),u.removeMessageListener(y)))}}}),_={aid:r.applicationId,a:r.accessLevel,id:r.id,l:r.linkType,ln:r.navEnabled,s:r.selectionMode,f:r.filter,v:r.viewType,ru:r.redirectUri,o:r.origin,sdk:h.default.SDK_VERSION_NUMBER,e:r.entryLocation,st:r.sourceTypes,sn:!r.parentDiv,ss:!r.parentDiv&&r.accountSwitchEnabled,tf:r.trapFocus,cm:r.commandMode,qos:r.qosExtraData},R=a.appendQueryString(w.url,"picker",JSON.stringify(_));if(E.default.logMessage("invoke picker with url: "+R),!r.parentDiv)return f.openPopup(R).then(function(){l({type:"cancel"})});f.close();var k=document.createElement("iframe");k.id="odpicker"+new Date().getTime(),k.style.position="relative",k.style.width="100%",k.style.height="100%",k.src=R,r.parentDiv.appendChild(k),w.iframe=k})},v.prototype.removeIFrame=function(){this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),this.iframe=null)},v}();i.default=P})(0,b,t("../models/ApiEndpoint"),t("../utilities/Channel"),t("../utilities/DomUtilities"),t("../utilities/ErrorHandler"),t("../models/ErrorType"),t("../utilities/Logging"),t("../models/OneDriveSdkError"),t("../utilities/UrlUtilities"),t("es6-promise"),t("../Constants"))},{"../Constants":1,"../models/ApiEndpoint":11,"../models/ErrorType":13,"../models/OneDriveSdkError":16,"../utilities/Channel":24,"../utilities/DomUtilities":25,"../utilities/ErrorHandler":26,"../utilities/Logging":27,"../utilities/UrlUtilities":32,"es6-promise":34}],10:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var g=function(h){te(d,h);function d(P){var v=p.shallowClone(P),r=new E.default(v);return h.call(this,r)||this}return d.prototype.buildPickerUXConfig=function(P){return{applicationId:P.clientId,accessLevel:"readwrite",id:a.generateNonce(),navEnabled:P.navEnabled,filter:P.filter,origin:window.location.origin,parentDiv:P.parentDiv,redirectUri:P.redirectUri,selectionMode:"single",viewType:"folders",accountSwitchEnabled:P.accountSwitchEnabled,commandMode:P.commandMode,qosExtraData:P.qosExtraData}},d.prototype.makeApiRequest=function(P){var v=this.invokerOptions;if(this.invokerOptions.action===s.default.query){var r=this.invokerOptions.queryParameters||e.default.DEFAULT_QUERY_ITEM_PARAMETER;return o.getItems(P,this.apiRequestConfig,r)}if(v.uploadType===c.default.dataUrl||v.uploadType===c.default.url){var f={name:v.fileName};return o.saveItemByUriUpload(P.value[0],f,v.sourceUri,this.apiRequestConfig)}if(v.uploadType===c.default.form)return f={name:v.fileName,"@name.conflictBehavior":v.nameConflictBehavior},o.saveItemByFormUpload(P.value[0],f,v.fileInput,this.apiRequestConfig,v.progress)},d}(u.default);i.default=g})(0,b,t("./ApiRequest"),t("../Constants"),t("./Invoker"),t("../utilities/ObjectUtilities"),t("../models/SaverActionType"),t("../models/SaverOptions"),t("../models/UploadType"),t("../utilities/UrlUtilities"))},{"../Constants":1,"../models/SaverActionType":19,"../models/SaverOptions":20,"../models/UploadType":21,"../utilities/ObjectUtilities":28,"../utilities/UrlUtilities":32,"./ApiRequest":4,"./Invoker":5}],11:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o;(function(e){e[e.filesV2=0]="filesV2",e[e.graph_odc=1]="graph_odc",e[e.graph_odb=2]="graph_odb",e[e.msa=3]="msa"})(o||(o={})),i.default=o})(0,b)},{}],12:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o;(function(e){e[e.aad=0]="aad",e[e.msa=1]="msa",e[e.tenant=2]="tenant"})(o||(o={})),i.default=o})(0,b)},{}],13:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o;(function(e){e[e.badResponse=0]="badResponse",e[e.fileReaderFailure=1]="fileReaderFailure",e[e.popupOpen=2]="popupOpen",e[e.unknown=3]="unknown",e[e.unsupportedFeature=4]="unsupportedFeature",e[e.webRequestFailure=5]="webRequestFailure",e[e.internalError=6]="internalError",e[e.optionsError=7]="optionsError",e[e.typeError=8]="typeError",e[e.popupClosed=9]="popupClosed"})(o||(o={})),i.default=o})(0,b)},{}],14:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c,a,g,h){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var d=new RegExp("^[a-fA-F\\d]{8}-([a-fA-F\\d]{4}-){3}[a-fA-F\\d]{12}$"),P=function(){function v(r){this.navEnabled=!0,this.needSharePointPermission=!0,this.clientId=g.validateType(r.clientId,e.default.TYPE_STRING);var f=g.validateCallback(r.cancel,!0);this.cancel=function(){E.default.logMessage("user cancelled operation"),f&&o.invokeAppCallback(f,!0)};var w=g.validateCallback(r.error,!0);this.error=function(m){if(!w)throw m;o.invokeAppCallback(w,!0,m)},this.parseAdvancedOptions(r),this.redirectUri=this.redirectUri||h.trimUrlQuery(window.location.href),this.endpointHint=this.endpointHint||u.default.aad;var l=r.advanced&&r.advanced.endpointHint;this.resource=l?h.getOrigin(l):void 0,this.forceAuthenticate=r.advanced&&r.advanced.forceAuthenticate,v.checkClientId(this.clientId)}return v.checkClientId=function(r){r?d.test(r)?E.default.logMessage("parsed client id: "+r):p.throwError(new c.default(s.default.unknown,a.format("invalid format for client id '{0}' - AAD: 32 characters (HEX) GUID",r))):p.throwError(new c.default(s.default.unknown,"client id is missing in options"))},v.prototype.needOauth=function(){return!!this.forceAuthenticate||this.needAPICall()&&!this.accessToken||this.endpointHint===u.default.aad},v.prototype.parseAdvancedOptions=function(r){if(r.advanced){if(r.advanced.redirectUri&&(h.validateRedirectUrlHost(r.advanced.redirectUri),this.redirectUri=r.advanced.redirectUri),r.advanced.queryParameters){var f=h.readUrlParameters("?"+r.advanced.queryParameters);for(var w in f)w.toLowerCase()!=="select"&&w.toLowerCase()!=="expand"&&p.throwError(new c.default(s.default.optionsError,a.format("unexpected query key: {0} is found in advanced.queryParameters",w)));var l=f.select,m=f.expand;l&&m?this.queryParameters=a.format("expand={0}&select={1}",m,l):m?this.queryParameters=a.format("expand={0}",m):l&&"select="+l.split(",").sort().join(",")!==e.default.DEFAULT_QUERY_ITEM_PARAMETER&&(this.queryParameters=a.format("select={0}",l))}if(r.advanced.endpointHint){if(r.advanced.endpointHint.toLowerCase()===e.default.VROOM_ENDPOINT_HINT)this.endpointHint=u.default.msa,r.advanced.isConsumerAccount===void 0&&(this.isConsumerAccount=!0);else{var y=g.validateType(r.advanced.endpointHint,"string",!1);h.validateUrlProtocol(y),this.endpointHint=u.default.tenant,r.advanced.isConsumerAccount===void 0&&(this.isConsumerAccount=!1),this.siteUrl=y}r.advanced.accessToken&&(this.accessToken=r.advanced.accessToken)}r.advanced.iframeParentDiv&&(r.advanced.iframeParentDiv.nodeName&&r.advanced.iframeParentDiv.nodeName.toLowerCase()==="div"||p.throwError(new c.default(s.default.optionsError,"the iframe's parent div element is not a DOM object")).exposeToPublic(),this.parentDiv=r.advanced.iframeParentDiv),r.advanced.scopes&&(typeof r.advanced.scopes=="string"?this.scopes=[r.advanced.scopes]:r.advanced.scopes instanceof Array&&(this.scopes=r.advanced.scopes)),this.linkType=r.advanced.linkType,this.parseNavigationOptions(r.advanced.navigation),this.loginHint=r.advanced.loginHint,this.trapFocus=r.advanced.trapFocus,typeof r.advanced.isConsumerAccount=="boolean"&&(this.isConsumerAccount=r.advanced.isConsumerAccount),this.filter=r.advanced.filter}},v.prototype.parseNavigationOptions=function(r){if(r){var f=r.entryLocation;if(f){if(f.sharePoint){var w=f.sharePoint,l=w.sitePath,m=w.listPath;l&&h.validateUrlProtocol(l,["HTTPS"]),m&&h.validateUrlProtocol(m,["HTTPS"])}this.navEntryLocation=f}var y=r.sourceTypes instanceof Array?r.sourceTypes:r.sourceTypes?[r.sourceTypes]:null;y&&(this.needSharePointPermission=!(y.length===1&&y[0].toLowerCase()==="onedrive"),this.navSourceTypes=y),this.navEnabled=!r.disable}},v}();i.default=P})(0,b,t("../utilities/CallbackInvoker"),t("../Constants"),t("./DomainHint"),t("../utilities/ErrorHandler"),t("./ErrorType"),t("../utilities/Logging"),t("./OneDriveSdkError"),t("../utilities/StringUtilities"),t("../utilities/TypeValidators"),t("../utilities/UrlUtilities"))},{"../Constants":1,"../utilities/CallbackInvoker":23,"../utilities/ErrorHandler":26,"../utilities/Logging":27,"../utilities/StringUtilities":30,"../utilities/TypeValidators":31,"../utilities/UrlUtilities":32,"./DomainHint":12,"./ErrorType":13,"./OneDriveSdkError":16}],15:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o;(function(e){e[e.AAD=0]="AAD",e[e.AADv2=1]="AADv2",e[e.MSA=2]="MSA"})(o||(o={})),i.default=o})(0,b)},{}],16:[function(t,A,b){(function(H,i,o,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var u=function(p){te(s,p);function s(E,c){var a=p.call(this,c)||this;return a.errorCode=o.default[E],a.message=c,a}return s.prototype.toString=function(){return e.format("[OneDriveSDK Error] errorType: {0}, message: {1}",this.errorCode,this.message)},s}(Error);i.default=u})(0,b,t("../models/ErrorType"),t("../utilities/StringUtilities"))},{"../models/ErrorType":13,"../utilities/StringUtilities":30}],17:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o;(function(e){e[e.download=0]="download",e[e.query=1]="query",e[e.share=2]="share"})(o||(o={})),i.default=o})(0,b)},{}],18:[function(t,A,b){(function(H,i,o,e,u,p,s,E){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var c=function(a){te(g,a);function g(h){var d=a.call(this,h)||this,P=E.validateCallback(h.success,!1);d.success=function(r){p.default.logMessage("picker operation succeeded"),o.invokeAppCallback(P,!0,r)},d.multiSelect=E.validateType(h.multiSelect,e.default.TYPE_BOOLEAN,!0,!1);var v=E.validateType(h.action,e.default.TYPE_STRING,!0,s.default[s.default.query]);return d.action=s.default[v],d.viewType=E.validateType(h.viewType,e.default.TYPE_STRING,!0,"files"),d.accountSwitchEnabled=E.validateType(h.accountSwitchEnabled,e.default.TYPE_BOOLEAN,!0,!0),d.commandMode=E.validateType(h.commandMode,e.default.TYPE_STRING,!0),d.qosExtraData=E.validateType(h.qosExtraData,e.default.TYPE_OBJECT,!0),d.commandMode===null&&(d.commandMode=void 0),d.qosExtraData===null&&(d.qosExtraData=void 0),h.advanced&&(d.createLinkParameters=h.advanced.createLinkParameters),d.scopes||(d.scopes=[d.action===s.default.share?"Files.ReadWrite":"Files.Read"]),d}return g.prototype.needAPICall=function(){return!!this.queryParameters||this.action!==s.default.query},g}(u.default);i.default=c})(0,b,t("../utilities/CallbackInvoker"),t("../Constants"),t("./InvokerOptions"),t("../utilities/Logging"),t("./PickerActionType"),t("../utilities/TypeValidators"))},{"../Constants":1,"../utilities/CallbackInvoker":23,"../utilities/Logging":27,"../utilities/TypeValidators":31,"./InvokerOptions":14,"./PickerActionType":17}],19:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o;(function(e){e[e.save=0]="save",e[e.query=1]="query"})(o||(o={})),i.default=o})(0,b)},{}],20:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c,a,g,h,d,P,v){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(f){te(w,f);function w(l){var m=f.call(this,l)||this,y=d.validateCallback(l.success,!1);m.success=function(k){c.default.logMessage("saver operation succeeded"),o.invokeAppCallback(y,!0,k)};var _=d.validateCallback(l.progress,!0);m.progress=function(k){c.default.logMessage(h.format("upload progress: {0}%",k)),_&&o.invokeAppCallback(_,!1,k)};var R=d.validateType(l.action,e.default.TYPE_STRING,!0,g.default[g.default.query]);return m.action=g.default[R],m.action===g.default.save&&m._setFileInfo(l),m.nameConflictBehavior=d.validateType(l.nameConflictBehavior,e.default.TYPE_STRING,!0,"rename"),m.scopes||(m.scopes=["Files.ReadWrite"]),m.commandMode=d.validateType(l.commandMode,e.default.TYPE_STRING,!0),m.qosExtraData=d.validateType(l.qosExtraData,e.default.TYPE_OBJECT,!0),m.commandMode===null&&(m.commandMode=void 0),m.qosExtraData===null&&(m.qosExtraData=void 0),m}return w.prototype.needAPICall=function(){return!!this.queryParameters||this.action===g.default.save},w.prototype._setFileInfo=function(l){l.sourceInputElementId&&l.sourceUri&&p.throwError(new a.default(s.default.optionsError,"sourceUri and sourceInputElementId are provided, only one is required.")),this.sourceInputElementId=l.sourceInputElementId,this.sourceUri=l.sourceUri;var m=d.validateType(l.fileName,e.default.TYPE_STRING,!0,null);this.sourceUri?v.isPathFullUrl(this.sourceUri)?(this.uploadType=P.default.url,this.fileName=m||v.getFileNameFromUrl(this.sourceUri),this.fileName||p.throwError(new a.default(s.default.optionsError,"must supply a file name or a URL that ends with a file name"))):v.isPathDataUrl(this.sourceUri)&&(this.uploadType=P.default.dataUrl,this.fileName=m,this.fileName||p.throwError(new a.default(s.default.optionsError,"must supply a file name for data URL uploads"))):this.sourceInputElementId?(this.uploadType=P.default.form,this.fileInput=u.getFileInput(this.sourceInputElementId),this.fileName=m||this.fileInput.name):p.throwError(new a.default(s.default.optionsError,"please specified one type of resource to save"))},w}(E.default);i.default=r})(0,b,t("../utilities/CallbackInvoker"),t("../Constants"),t("../utilities/DomUtilities"),t("../utilities/ErrorHandler"),t("./ErrorType"),t("./InvokerOptions"),t("../utilities/Logging"),t("./OneDriveSdkError"),t("./SaverActionType"),t("../utilities/StringUtilities"),t("../utilities/TypeValidators"),t("./UploadType"),t("../utilities/UrlUtilities"))},{"../Constants":1,"../utilities/CallbackInvoker":23,"../utilities/DomUtilities":25,"../utilities/ErrorHandler":26,"../utilities/Logging":27,"../utilities/StringUtilities":30,"../utilities/TypeValidators":31,"../utilities/UrlUtilities":32,"./ErrorType":13,"./InvokerOptions":14,"./OneDriveSdkError":16,"./SaverActionType":19,"./UploadType":21}],21:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o;(function(e){e[e.dataUrl=0]="dataUrl",e[e.form=1]="form",e[e.url=2]="url"})(o||(o={})),i.default=o})(0,b)},{}],22:[function(t,A,b){(function(H,i,o,e,u){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var p="odpickerv7cache";i.getCacheItem=function(c){return s()[c]},i.setCacheItem=function(c,a){var g=s();g[c]=a,E(g)},i.removeCacheItem=function(c){var a=s(),g=a[c];return delete a[c],E(a),g};function s(){if(Storage){var c=localStorage.getItem(p);return JSON.parse(c||"{}")}e.throwError(new u.default(o.default.unsupportedFeature,"cache based on Storage is not supported in this browser"))}function E(c){Storage?localStorage.setItem(p,JSON.stringify(c)):e.throwError(new u.default(o.default.unsupportedFeature,"cache based on Storage is not supported in this browser"))}})(0,b,t("../models/ErrorType"),t("./ErrorHandler"),t("../models/OneDriveSdkError"))},{"../models/ErrorType":13,"../models/OneDriveSdkError":16,"./ErrorHandler":26}],23:[function(t,A,b){(function(H,i,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.invokeAppCallback=function(e,u){for(var p=[],s=2;s<arguments.length;s++)p[s-2]=arguments[s];typeof e===o.default.TYPE_FUNCTION&&e.apply(null,p)},i.invokeCallbackAsynchronous=function(e){for(var u=[],p=1;p<arguments.length;p++)u[p-1]=arguments[p];window.setTimeout(function(){e.apply(null,u)},0)}})(0,b,t("../Constants"))},{"../Constants":1}],24:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(u){this.receiver=u}return e.prototype.send=function(u,p){this.receiver&&this.receiver.postMessage(u,p)},e.prototype.getReceiver=function(){return this.receiver},e}();i.default=o})(0,b)},{}],25:[function(t,A,b){(function(H,i,o,e,u,p){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s={};function E(a){return document.getElementById(a)}i.getElementById=E;function c(a){document.readyState==="interactive"||document.readyState==="complete"?a():document.addEventListener("DOMContentLoaded",a,!1)}i.onDocumentReady=c,i.onMessage=function(a){var g=p.generateNonce()+"_"+new Date().getMilliseconds();return window.addEventListener("message",a),s[g]=a,g},i.removeMessageListener=function(a){var g=s[a];g&&window.removeEventListener("message",g)},i.getFileInput=function(a){var g=E(a);if(g instanceof HTMLInputElement){if(g.type!=="file"&&o.throwError(new u.default(e.default.optionsError,"input elemenet must be of type 'file'")),!g.value)return o.throwError(new u.default(e.default.optionsError,"please a file to upload")),null;var h=g.files;h&&window.FileReader||o.throwError(new u.default(e.default.unsupportedFeature,"browser does not support Files API")),h.length!==1&&o.throwError(new u.default(e.default.unsupportedFeature,"can not upload more than one file at a time"));var d=h[0];return d||o.throwError(new u.default(e.default.optionsError,"missing file input")),104857600<d.size?(o.throwError(new u.default(e.default.optionsError,"the user has selected a file larger than 100 MB")),null):d}o.throwError(new u.default(e.default.unknown,"element was not an instance of an HTMLInputElement"))},i.displayOverlay=function(){var a=document.createElement("div");a.id="od-overlay",a.style.cssText=["position: fixed","width: 100%","height: 100%","top: 0px","left: 0px","background-color: white","opacity: 1","z-index: 10000","min-width: 40px","min-height: 40px"].join(";");var g=document.createElement("img");g.id="od-spinner",g.src="https://p.sfx.ms/common/spinner_grey_40_transparent.gif",g.style.cssText=["position: absolute","margin: auto","top: 0","left: 0","right: 0","bottom: 0"].join(";"),a.appendChild(g);var h=document.createElement("style");h.type="text/css",h.innerHTML="body { visibility: hidden !important; }",document.head.appendChild(h),c(function(){var d=document.body;d!==null?d.insertBefore(a,d.firstChild):document.createElement("body").appendChild(a),document.head.removeChild(h)})}})(0,b,t("./ErrorHandler"),t("../models/ErrorType"),t("../models/OneDriveSdkError"),t("./UrlUtilities"))},{"../models/ErrorType":13,"../models/OneDriveSdkError":16,"./ErrorHandler":26,"./UrlUtilities":32}],26:[function(t,A,b){(function(H,i,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=[];i.registerErrorObserver=function(u){e.push(u)},i.throwError=function(u){if(u.errorCode!==o.default[o.default.unknown]){for(var p=0,s=e;p<s.length;p++)(0,s[p])(u);return{exposeToPublic:function(){throw u}}}throw u}})(0,b,t("../models/ErrorType"))},{"../models/ErrorType":13}],27:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(){}return e.logError=function(u){for(var p=[],s=1;s<arguments.length;s++)p[s-1]=arguments[s];e._log(u,!0,p)},e.logMessage=function(u){e._log(u,!1)},e._log=function(u,p){for(var s=[],E=2;E<arguments.length;E++)s[E-2]=arguments[E];(p||e.loggingEnabled||window.onedrive_enable_logging)&&console.log("[OneDriveSDK] "+u,s)},e.loggingEnabled=!1,e}();i.default=o})(0,b)},{}],28:[function(t,A,b){(function(H,i,o,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.shallowClone=function(u){if(typeof u!==o.default.TYPE_OBJECT||!u)return null;var p={};for(var s in u)u.hasOwnProperty(s)&&(p[s]=u[s]);return p},i.deserializeJSON=function(u){var p=null;try{p=JSON.parse(u)}catch(s){e.default.logError("deserialization error"+s)}return typeof p===o.default.TYPE_OBJECT&&p!==null||(p={}),p},i.serializeJSON=function(u){return JSON.stringify(u)}})(0,b,t("../Constants"),t("./Logging"))},{"../Constants":1,"./Logging":27}],29:[function(t,A,b){(function(H,i,o,e,u,p,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.POPUP_PINGER_INTERVAL=500;var E=function(){function c(){}return c.getCurrentPopup=function(){return c._currentPopup||new c},c.setCurrentPopup=function(a){c._currentPopup=a},c.createPopupFeatures=function(){var a=window.screenX+Math.max(window.outerWidth-1024,0)/2;return["width=1024","height=650","top="+(window.screenY+Math.max(window.outerHeight-650,0)/2),"left="+a,"status=no","resizable=yes","toolbar=no","menubar=no","scrollbars=yes"].join(",")},c.prototype.close=function(){c.getCurrentPopup().isPopupOpen()&&(c.getCurrentPopup()._popup.close(),c.setCurrentPopup(null))},c.prototype.openPopup=function(a){var g=this;return s.validateUrlProtocol(a),c.getCurrentPopup().isPopupOpen()?(u.default.logMessage("leaving current url: "+this._url),this._url=a,c.getCurrentPopup().getPopupWindow().location.href=a):(this._url=a,this._popup=window.open(a,"_blank",c.createPopupFeatures()),this._popup?this._popup.focus():o.throwError(new p.default(e.default.popupOpen,"popup window is disconnected")).exposeToPublic(),c.setCurrentPopup(this)),new Promise(function(h,d){var P=setInterval(function(){g.isPopupOpen()||(window.clearInterval(P),h())},i.POPUP_PINGER_INTERVAL)})},c.prototype.getPopupWindow=function(){return this._popup},c.prototype.getCurrentUrl=function(){return this._url},c.prototype.isPopupOpen=function(){return!!this._popup&&!this._popup.closed},c}();i.default=E})(0,b,t("./ErrorHandler"),t("../models/ErrorType"),t("./Logging"),t("../models/OneDriveSdkError"),t("../utilities/UrlUtilities"))},{"../models/ErrorType":13,"../models/OneDriveSdkError":16,"../utilities/UrlUtilities":32,"./ErrorHandler":26,"./Logging":27}],30:[function(t,A,b){(function(H,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=/[\{\}]/g,e=/\{\d+\}/g;i.format=function(u){for(var p=[],s=1;s<arguments.length;s++)p[s-1]=arguments[s];return u.replace(e,function(E){var c=p[E.replace(o,"")];return c===null&&(c=""),c})}})(0,b)},{}],31:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.validateType=function(a,g,h,d,P){if(h===void 0&&(h=!1),a===void 0){if(h){if(d!==void 0)return p.default.logMessage("applying default value: "+d),d}else e.throwError(new E.default(u.default.typeError,"object was missing and not optional"));return null}var v=typeof a;return v!==g?(e.throwError(new E.default(u.default.typeError,c.format("expected object type: '{0}', actual object type: '{1}'",g,v))),null):function(r,f){if(!Array.isArray(f))return!0;for(var w in f)if(r===f[w])return!0;return!1}(a,P)?a:(e.throwError(new E.default(u.default.typeError,c.format("object does not match any valid values {0}",s.serializeJSON(P)))),null)},i.validateCallback=function(a,g){if(g===void 0&&(g=!1),a===void 0)return g||e.throwError(new E.default(u.default.typeError,"function was missing and not optional")),null;var h=typeof a;return h!==o.default.TYPE_FUNCTION&&e.throwError(new E.default(u.default.typeError,c.format("expected function type: function | string, actual type: {0}",h))),a}})(0,b,t("../Constants"),t("./ErrorHandler"),t("../models/ErrorType"),t("./Logging"),t("./ObjectUtilities"),t("../models/OneDriveSdkError"),t("./StringUtilities"))},{"../Constants":1,"../models/ErrorType":13,"../models/OneDriveSdkError":16,"./ErrorHandler":26,"./Logging":27,"./ObjectUtilities":28,"./StringUtilities":30}],32:[function(t,A,b){(function(H,i,o,e,u,p,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var E="HTTP",c="HTTPS";function a(r,f){return r+(r.charAt(r.length-1)!=="/"?"/":"")+f}i.appendToPath=a,i.appendQueryString=function(r,f,w){return g(r,((l={})[f]=w,l));var l};function g(r,f,w){if(!f||Object.keys(f).length===0)return r;w?r+="#":r.indexOf("?")===-1?r+="?":r.charAt(r.length-1)!=="&"&&(r+="&");var l="";for(var m in f)l+=(l.length?"&":"")+s.format("{0}={1}",encodeURIComponent(m),encodeURIComponent(f[m]));return r+l}i.appendQueryStrings=g,i.readCurrentUrlParameters=function(){return h(window.location.href)};function h(r){var f={},w=r.indexOf("?")+1,l=r.indexOf("#")+1;if(0<w){var m=w<l?l-1:r.length;v(r.substring(w,m),f)}return 0<l&&v(r.substring(l),f),f}i.readUrlParameters=h,i.redirect=function(r){P(r),window.location.replace(r)};function d(r){var f=["?","#"];for(var w in f){var l=r.indexOf(f[w]);0<l&&(r=r.substring(0,l))}return r}i.trimUrlQuery=d,i.getFileNameFromUrl=function(r){var f=d(r);return f.substr(f.lastIndexOf("/")+1)},i.getOrigin=function(r){return a(r.replace(/^((\w+:)?\/\/[^\/]+\/?).*$/,"$1"),"")},i.isPathFullUrl=function(r){return r.indexOf("https://")===0||r.indexOf("http://")===0},i.isPathDataUrl=function(r){return r.indexOf("data:")===0},i.generateNonce=function(){for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",f="",w=0;w<o.default.NONCE_LENGTH;w++)f+=r.charAt(Math.floor(Math.random()*r.length));return f};function P(r,f){for(var w=0,l=f=f||[E,c];w<l.length;w++){var m=l[w];if(r.toUpperCase().indexOf(m)===0)return}e.throwError(new p.default(u.default.optionsError,s.format("uri {0} does not match protocol(s): "+f,r))).exposeToPublic()}i.validateUrlProtocol=P,i.validateRedirectUrlHost=function(r){P(r),-1<r.indexOf("://")?r.split("/")[2]!==window.location.host&&e.throwError(new p.default(u.default.optionsError,"redirect uri is not in the same domain as picker sdk")).exposeToPublic():e.throwError(new p.default(u.default.optionsError,"redirect uri is not an absolute url")).exposeToPublic()};function v(r,f){for(var w=r.split("&"),l=0;l<w.length;l++){var m=w[l],y=m.indexOf("=");if(y!==-1){var _=m.substr(0,y),R=m.substr(y+1);f[_]=decodeURIComponent(R)}}}i.deserializeParameters=v})(0,b,t("../Constants"),t("./ErrorHandler"),t("../models/ErrorType"),t("../models/OneDriveSdkError"),t("./StringUtilities"))},{"../Constants":1,"../models/ErrorType":13,"../models/OneDriveSdkError":16,"./ErrorHandler":26,"./StringUtilities":30}],33:[function(t,A,b){(function(H,i,o,e,u,p,s,E,c){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=new RegExp("^([a-fA-F0-9]){16}$"),g=function(){function h(d){this._url=d.url,this._json=d.json,this._headers=d.headers||{},this._method=d.method,this._clientId=d.clientId,this._apiEndpoint=d.apiEndpoint||o.default.msa,u.registerErrorObserver(this._abortRequest)}return h.statusCodeToString=function(d){switch(d){case-1:return"EXCEPTION";case-2:return"TIMEOUT";case-3:return"REQUEST ABORTED";default:return d.toString()}},h.prototype.start=function(d,P){var v=this;try{this._successCallback=d,this._failureCallback=P,this._request=new XMLHttpRequest,this._request.ontimeout=this._onTimeout,this._request.onload=function(){var r=v._request.status;r<400&&0<r?v._callSuccessCallback(r):v._callFailureCallback(r)},this._method||(this._method=this._json?h.HTTP_POST:h.HTTP_GET),this._request.open(this._method,this._url,!0),this._request.timeout=3e4,this._setHeaders(),s.default.logMessage("starting request to: "+this._url),this._request.send(this._json)}catch(r){this._callFailureCallback(-1,r)}},h.prototype.upload=function(d,P,v,r){var f=this;try{this._successCallback=P,this._progressCallback=r,this._failureCallback=v,this._request=new XMLHttpRequest,this._request.ontimeout=this._onTimeout,this._method=h.HTTP_PUT,this._request.open(this._method,this._url,!0),this._setHeaders(),this._request.onload=function(w){f._completed=!0;var l=f._request.status;l===200||l===201||l===202?f._callSuccessCallback(l):f._callFailureCallback(l,w)},this._request.onerror=function(w){f._completed=!0,f._callFailureCallback(f._request.status,w)},this._request.upload.onprogress=function(w){if(w.lengthComputable){var l={bytesTransferred:w.loaded,totalBytes:w.total,progressPercentage:w.total===0?0:w.loaded/w.total*100};f._callProgressCallback(l)}},s.default.logMessage("starting upload to: "+this._url),this._request.send(d)}catch(w){this._callFailureCallback(-1,w)}},h.prototype._callSuccessCallback=function(d){s.default.logMessage("calling xhr success callback, status: "+h.statusCodeToString(d)),this._successCallback(this._request,d,this._url)},h.prototype._callFailureCallback=function(d,P){s.default.logError("calling xhr failure callback, status: "+h.statusCodeToString(d),this._request,P),this._failureCallback(this._request,d,d===-2)},h.prototype._callProgressCallback=function(d){s.default.logMessage("calling xhr upload progress callback"),this._progressCallback(this._request,d)},h.prototype._abortRequest=function(){if(this&&!this._completed){if(this._completed=!0,this._request)try{this._request.abort()}catch{}this._callFailureCallback(-3)}},h.prototype._onTimeout=function(){this._completed||(this._completed=!0,this._callFailureCallback(-2))},h.prototype._setHeaders=function(){for(var d in this._headers)this._request.setRequestHeader(d,this._headers[d]);if(this._clientId){var P=this._clientId;a.test(this._clientId)&&(P="0x"+this._clientId),this._request.setRequestHeader("Application","0x"+P)}var v=c.format("{0}={1}","SDK-Version",e.default.SDK_VERSION);switch(this._apiEndpoint){case o.default.graph_odb:case o.default.filesV2:this._request.setRequestHeader("X-ClientService-ClientTag",v);break;case o.default.graph_odc:case o.default.msa:this._request.setRequestHeader("X-RequestStats",v);break;default:u.throwError(new E.default(p.default.internalError,"invalid API endpoint: "+this._apiEndpoint))}this._method===h.HTTP_POST&&this._request.setRequestHeader("Content-Type",this._json?"application/json":"text/plain")},h.HTTP_GET="GET",h.HTTP_POST="POST",h.HTTP_PUT="PUT",h}();i.default=g})(0,b,t("../models/ApiEndpoint"),t("../Constants"),t("./ErrorHandler"),t("../models/ErrorType"),t("./Logging"),t("../models/OneDriveSdkError"),t("./StringUtilities"))},{"../Constants":1,"../models/ApiEndpoint":11,"../models/ErrorType":13,"../models/OneDriveSdkError":16,"./ErrorHandler":26,"./Logging":27,"./StringUtilities":30}],34:[function(t,A,b){H=this,i=function(){"use strict";function o(n){return typeof n=="function"}var e=Array.isArray?Array.isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"},u=0,p=void 0,s=void 0,E=function(n,T){v[u]=n,v[u+1]=T,(u+=2)===2&&(s?s(r):f())},c=typeof window<"u"?window:void 0,a=c||{},g=a.MutationObserver||a.WebKitMutationObserver,h=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",d=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function P(){var n=setTimeout;return function(){return n(r,1)}}var v=new Array(1e3);function r(){for(var n=0;n<u;n+=2)(0,v[n])(v[n+1]),v[n]=void 0,v[n+1]=void 0;u=0}var f=void 0;f=h?function(){return process.nextTick(r)}:g?function(){var n=0,T=new g(r),I=document.createTextNode("");return T.observe(I,{characterData:!0}),function(){I.data=n=++n%2}}():d?function(){var n=new MessageChannel;return n.port1.onmessage=r,function(){return n.port2.postMessage(0)}}():c===void 0&&typeof t=="function"?function(){try{var n=t("vertx");return p=n.runOnLoop||n.runOnContext,function(){p(r)}}catch{return P()}}():P();function w(n,T){var I=arguments,q=this,j=new this.constructor(y);j[m]===void 0&&G(j);var N,J=q._state;return J?(N=I[J-1],E(function(){return Q(J,j,N,q._result)})):x(q,j,n,T),j}function l(n){if(n&&typeof n=="object"&&n.constructor===this)return n;var T=new this(y);return L(T,n),T}var m=Math.random().toString(36).substring(16);function y(){}var _=void 0,R=1,k=2,O=new Y;function D(n){try{return n.then}catch(T){return O.error=T,O}}function C(n,T,I){T.constructor===n.constructor&&I===w&&T.constructor.resolve===l?(N=n,(J=T)._state===R?U(N,J._result):J._state===k?S(N,J._result):x(J,void 0,function(z){return L(N,z)},function(z){return S(N,z)})):I===O?S(n,O.error):I===void 0?U(n,T):o(I)?(q=T,j=I,E(function(z){var W=!1,re=function($,ne,ae,se){try{$.call(ne,ae,se)}catch(ue){return ue}}(j,q,function($){W||(W=!0,q!==$?L(z,$):U(z,$))},function($){W||(W=!0,S(z,$))},z._label);!W&&re&&(W=!0,S(z,re))},n)):U(n,T);var q,j,N,J}function L(n,T){n===T?S(n,new TypeError("You cannot resolve a promise with itself")):typeof(I=T)=="function"||typeof I=="object"&&I!==null?C(n,T,D(T)):U(n,T);var I}function M(n){n._onerror&&n._onerror(n._result),F(n)}function U(n,T){n._state===_&&(n._result=T,n._state=R,n._subscribers.length!==0&&E(F,n))}function S(n,T){n._state===_&&(n._state=k,n._result=T,E(M,n))}function x(n,T,I,q){var j=n._subscribers,N=j.length;n._onerror=null,j[N]=T,j[N+R]=I,j[N+k]=q,N===0&&n._state&&E(F,n)}function F(n){var T=n._subscribers,I=n._state;if(T.length!==0){for(var q=void 0,j=void 0,N=n._result,J=0;J<T.length;J+=3)q=T[J],j=T[J+I],q?Q(I,q,j,N):j(N);n._subscribers.length=0}}function Y(){this.error=null}var V=new Y;function Q(n,T,I,q){var j=o(I),N=void 0,J=void 0,z=void 0,W=void 0;if(j){if((N=function(re,$){try{return re($)}catch(ne){return V.error=ne,V}}(I,q))===V?(W=!0,J=N.error,N=null):z=!0,T===N){S(T,new TypeError("A promises callback cannot return that same promise."));return}}else N=q,z=!0;T._state!==_||(j&&z?L(T,N):W?S(T,J):n===R?U(T,N):n===k&&S(T,N))}var K=0;function G(n){n[m]=K++,n._state=void 0,n._result=void 0,n._subscribers=[]}function X(n,T){this._instanceConstructor=n,this.promise=new n(y),this.promise[m]||G(this.promise),e(T)?(this._input=T,this.length=T.length,this._remaining=T.length,this._result=new Array(this.length),this.length===0?U(this.promise,this._result):(this.length=this.length||0,this._enumerate(),this._remaining===0&&U(this.promise,this._result))):S(this.promise,new Error("Array Methods must be provided an Array"))}X.prototype._enumerate=function(){for(var n=this.length,T=this._input,I=0;this._state===_&&I<n;I++)this._eachEntry(T[I],I)},X.prototype._eachEntry=function(n,T){var I=this._instanceConstructor,q=I.resolve;if(q===l){var j=D(n);if(j===w&&n._state!==_)this._settledAt(n._state,T,n._result);else if(typeof j!="function")this._remaining--,this._result[T]=n;else if(I===B){var N=new I(y);C(N,n,j),this._willSettleAt(N,T)}else this._willSettleAt(new I(function(J){return J(n)}),T)}else this._willSettleAt(q(n),T)},X.prototype._settledAt=function(n,T,I){var q=this.promise;q._state===_&&(this._remaining--,n===k?S(q,I):this._result[T]=I),this._remaining===0&&U(q,this._result)},X.prototype._willSettleAt=function(n,T){var I=this;x(n,void 0,function(q){return I._settledAt(R,T,q)},function(q){return I._settledAt(k,T,q)})};function B(n){this[m]=K++,this._result=this._state=void 0,this._subscribers=[],y!==n&&(typeof n!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof B?function(T,I){try{I(function(q){L(T,q)},function(q){S(T,q)})}catch(q){S(T,q)}}(this,n):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}B.all=function(n){return new X(this,n).promise},B.race=function(n){var T=this;return e(n)?new T(function(I,q){for(var j=n.length,N=0;N<j;N++)T.resolve(n[N]).then(I,q)}):new T(function(I,q){return q(new TypeError("You must pass an array to race."))})},B.resolve=l,B.reject=function(n){var T=new this(y);return S(T,n),T},B._setScheduler=function(n){s=n},B._setAsap=function(n){E=n},B._asap=E,B.prototype={constructor:B,then:w,catch:function(n){return this.then(null,n)}};function Z(){var n=void 0;if(typeof global<"u")n=global;else if(typeof self<"u")n=self;else try{n=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var T=n.Promise;if(T){var I=null;try{I=Object.prototype.toString.call(T.resolve())}catch{}if(I==="[object Promise]"&&!T.cast)return}n.Promise=B}return Z(),B.polyfill=Z,B.Promise=B},typeof b=="object"&&A!==void 0?A.exports=i():H.ES6Promise=i();var H,i},{}]},{},[2])(2)})});export default de();
